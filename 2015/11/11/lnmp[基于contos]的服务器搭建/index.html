<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>lnmp服务器搭建 | Xiaoyanegr - Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="nginx+mysql+php[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.812345根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。$&amp;amp;: mkdir -p /home/tool">
<meta property="og:type" content="article">
<meta property="og:title" content="lnmp服务器搭建">
<meta property="og:url" content="http://yoursite.com/2015/11/11/lnmp[基于contos]的服务器搭建/index.html">
<meta property="og:site_name" content="Xiaoyanegr - Hexo">
<meta property="og:description" content="nginx+mysql+php[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.812345根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。$&amp;amp;: mkdir -p /home/tool">
<meta property="og:updated_time" content="2015-12-09T09:20:41.416Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="lnmp服务器搭建">
<meta name="twitter:description" content="nginx+mysql+php[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.812345根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。$&amp;amp;: mkdir -p /home/tool">
  
    <link rel="alternative" href="/atom.xml" title="Xiaoyanegr - Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Xiaoyanegr - Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="[layout]-lnmp[基于contos]的服务器搭建" class="article article-type-[layout]" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/11/lnmp[基于contos]的服务器搭建/" class="article-date">
  <time datetime="2015-11-10T16:00:00.000Z" itemprop="datePublished">2015-11-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      lnmp服务器搭建
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>nginx+mysql+php<br><a href="http://www.lmyw.net.cn/?p=487" target="_blank" rel="external">[转自老马运维，十分感谢]</a><br>centos:7.1.1503 64位系统<br>nginx:1.8.0<br>mysql:5.6.24<br>php:5.6.8<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">根据生产环境安装操作系统（centos <span class="number">7.1</span><span class="number">.1503</span> <span class="number">64</span>位系统），安装完成后，使用Xshell通过ssh协议连接服务器。</span><br><span class="line">ssh 用户名<span class="annotation">@IP</span>+回车+输入密码后登录系统。</span><br><span class="line">$&amp;: mkdir -p <span class="regexp">/home/</span>tools</span><br><span class="line">$&amp;: cd <span class="regexp">/home/</span>tools</span><br><span class="line">将软件包上传到<span class="regexp">/home/</span>tools</span><br></pre></td></tr></table></figure></p>
<p>修改网卡的配置文件<br>$&amp;: vim /etc/sysconfig/network-scripts/ifcfg-ens32 //ifcfg-ens32是网卡的设备名称，每个机器的设备名不一样，修改的时候改成自己机器的设备名称<br>HWADDR=00:1e:37:25:92:77 //改成自己机器的MAC地址<br>TYPE=Ethernet<br>BOOTPROTO=static<br>DEFROUTE=yes<br>PEERDNS=yes<br>PEERROUTES=yes<br>USERCTL=no<br>NM_CONTROLLED=no<br>IPV4_FAILURE_FATAL=no<br>IPV6INIT=yes<br>IPV6_AUTOCONF=yes<br>IPV6_DEFROUTE=yes<br>IPV6_PEERDNS=yes<br>IPV6_PEERROUTES=yes<br>IPV6_FAILURE_FATAL=no<br>NAME=eno16777736<br>ONBOOT=yes<br>IPADDR=192.168.1.91<br>NETMASK=255.255.255.0<br>GATEWAY=192.168.1.1<br>DNS1=202.106.0.20<br>$&amp;: systemctl -f restart NetworkManager<br>关键配置：<br>TYPE=Ethernet<br>BOOTPROTO=static<br>NAME=eno16777736<br>ONBOOT=yes<br>IPADDR=192.168.117.128<br>NETMASK=255.255.255.0<br>GATEWAY=192.168.117.2<br>DNS1=192.168.117.2<br>$&amp;: cat /etc/resolv.conf<br>nameserver 192.168.117.2<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建软件包存储目录</span><br><span class="line"><span class="variable">$&amp;</span>: cd /home/</span><br><span class="line"><span class="variable">$&amp;</span>: mkdir tools</span><br><span class="line"><span class="variable">$&amp;</span>: cd tools/</span><br></pre></td></tr></table></figure></p>
<p>安装系统程序<br>$&amp;: yum -y install wget<br>$&amp;: yum -y install vim<em><br>$&amp;: yum -y install ntpdate<br>$&amp;: yum -y install mlocate<br>$&amp;: updatedb<br>$&amp;: yum -y install lrzsz</em> //可安装可不安装<br>$&amp;: yum -y install openssl*<br>$&amp;: yum -y install pcre-devel<br>$&amp;: yum -y install ncurses-devel<br>$&amp;: yum -y install gcc python-devel<br>$&amp;: service iptables stop<br>centos 7.0执行如下内容<br>$&amp;: systemctl start firewalld.service //启动firewall<br>$&amp;: systemctl stop firewalld.service //停止firewall<br>$&amp;: systemctl disable firewalld.service //禁止firewall开机启动<br>$&amp;: chmod +x /etc/rc.d/rc.local //设置开机启动项脚本权限<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">时间同步</span><br><span class="line"><span class="variable">$&amp;</span>: <span class="regexp">/usr/sbin</span><span class="regexp">/ntpdate us.pool.ntp.org | logger -t NTP /</span><span class="regexp">/ 0-59/</span><span class="number">10</span> * * * * <span class="regexp">/usr/sbin</span><span class="regexp">/ntpdate us.pool.ntp.org | logger -t NTP(每隔10分钟同步一下时钟)</span></span><br></pre></td></tr></table></figure></p>
<p>下载nginx、pcre、zlib<br>$&amp;: wget <a href="http://nginx.org/download/nginx-1.8.0.tar.gz" target="_blank" rel="external">http://nginx.org/download/nginx-1.8.0.tar.gz</a><br>$&amp;: wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre2-10.00.tar.gz<br>$&amp;: wget <a href="http://zlib.net/zlib-1.2.8.tar.gz" target="_blank" rel="external">http://zlib.net/zlib-1.2.8.tar.gz</a><br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">安装pcre</span><br><span class="line"><span class="variable">$&amp;</span>: tar -zxvf pcre2-<span class="number">10.00</span>.tar.gz</span><br><span class="line"><span class="variable">$&amp;</span>: cd pcre2-<span class="number">10.00</span>/</span><br><span class="line"><span class="variable">$&amp;</span>: ./configure</span><br><span class="line"><span class="variable">$&amp;</span>: make</span><br><span class="line"><span class="variable">$&amp;</span>: make install</span><br><span class="line"><span class="variable">$&amp;</span>: cd /home/tools/</span><br></pre></td></tr></table></figure></p>
<p>安装zlib<br>$&amp;: tar -zxvf zlib-1.2.8.tar.gz<br>$&amp;: cd zlib-1.2.8<br>$&amp;: ./configure<br>$&amp;: make<br>$&amp;: make install<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">安装第三方软件源</span><br><span class="line">$&amp;: wget http:<span class="comment">//packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el5.rf.x86_64.rpm</span></span><br><span class="line">$&amp;: rpm -ivh rpmforge-release-<span class="number">0.5</span>.<span class="number">2</span>-<span class="number">2</span><span class="class">.el5</span><span class="class">.rf</span><span class="class">.x86_64</span><span class="class">.rpm</span></span><br></pre></td></tr></table></figure></p>
<p>安装nginx</p>
<p>$&amp;: cd /home/tools/<br>$&amp;: tar -zxvf nginx-1.8.0.tar.gz<br>$&amp;: cd nginx-1.8.0/<br>$&amp;: /usr/sbin/groupadd www<br>$&amp;: /usr/sbin/useradd -g www www<br>$&amp;: ./configure –user=www –group=www –with-http_stub_status_module –with-http_gzip_static_module –prefix=/usr/local/nginx<br>$&amp;: ./configure –user=www –group=www –with-http_stub_status_module –with-http_gzip_static_module –with-http_ssl_module –prefix=/usr/local/nginx //支持https<br>$&amp;: make<br>$&amp;: make install<br>$&amp;: mkdir -p /home/logs<br>$&amp;: mkdir -p /home/logs/api.m.woniuanjia.com<br>$&amp;: mkdir -p /home/logs/www.m.woniuanjia.com<br>$&amp;: mkdir -p /home/logs/demo.woniuanjia.com<br>$&amp;: mkdir -p /home/app/api.m.woniuanjia.com<br>$&amp;: mkdir -p /home/app/www.m.woniuanjia.com<br>$&amp;: mkdir -p /home/app/demo.woniuanjia.com<br>$&amp;: mkdir /home/logs/nginx-log/<br>$&amp;: chmod +w /home/logs<br>$&amp;: chmod +w /home/app/api.m.woniuanjia.com/<br>$&amp;: chmod +w /home/app/www.m.woniuanjia.com/<br>$&amp;: chmod +w /home/app/demo.woniuanjia.com/<br>$&amp;: chmod +w /home/logs/nginx-log/<br>$&amp;: chown -R www:www /home/logs/<br>$&amp;: chown -R www:www /home/app/<br>$&amp;: chown -R www:www /home/logs/nginx-log/<br>$&amp;: mkdir -p /home/nginx/logs/<br>$&amp;: vim /etc/passwd<br>www:x:500:500::/home/www:/sbin/nologin<br>$&amp;: cp /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf.bak<br>$&amp;: cat /dev/null &gt;/usr/local/nginx/conf/nginx.conf<br>$&amp;: vim /usr/local/nginx/conf/nginx.conf<br>user www www;<br>worker_processes 2;<br>worker_cpu_affinity 0101 1010;<br>error_log /home/logs/nginx-log/error.log crit;<br>pid /usr/local/nginx/logs/nginx.pid;<br>worker_rlimit_nofile 65535;<br>events {<br>use epoll;<br>worker_connections 65535;<br>}<br>http {<br>include mime.types;<br>default_type application/octet-stream;<br>charset utf-8;<br>log_format access ‘$remote_addr – $remote_user [$time_local] “$request” $status $body_bytes_sent “$http_referer” “$http_user_agent” “$http_x_forwarded_for” host’;<br>server_names_hash_bucket_size 128;<br>client_header_buffer_size 4k;<br>large_client_header_buffers 4 4k;<br>sendfile on;<br>tcp_nopush on;<br>tcp_nodelay on;<br>server_tokens off;<br>keepalive_timeout 60;<br>gzip on;<br>gzip_min_length 1k;<br>gzip_buffers 4 16k;<br>gzip_http_version 1.1;<br>gzip_comp_level 4;<br>$&amp;: gzip_types text/plain application/x-javascript text/css application/xml;<br>gzip_types text/plain application/x-javascript text/css;<br>gzip_vary on;<br>server {<br>listen 80 default;<br>return 200;<br>}<br>$&amp;: 以上为默认增加的nginx配置<br>$&amp;: 以下为蜗牛项目在线host配置<br>$&amp;:  host.woniu.com #<br>server {<br>listen 80;<br>server_name host.woniu.com 192.168.1.91;<br>root /home/app/host.woniu.com/;<br>}<br>$&amp;: 以下为新增的nginx配置<br>$&amp;: api.m.woniuanjia.com#<br>server {<br>listen 80;<br>server_name api.m.woniuanjia.com;<br>charset utf-8;<br>root /home/app/api.m.woniuanjia.com/v1.0/web/;<br>location / {<br>index index.php index.html index.htm;<br>}<br>location /v1.0/ {<br>index index.php;<br>alias /home/app/api.m.woniuanjia.com/v1.0/web/;<br>}<br>error_page 500 502 503 504 /50x.html;<br>location = /50x.html {<br>root html;<br>}<br>location ~ ^/v1.0/(.<em>.php)$ {<br>fastcgi_pass 127.0.0.1:9000;<br>fastcgi_index index.php;<br>fastcgi_param SCRIPT_FILENAME /home/app/api.m.woniuanjia.com/v1.0/web/$1;<br>include fastcgi_params;<br>}<br>location ~ .php$ {<br>fastcgi_pass 127.0.0.1:9000;<br>fastcgi_index index.php;<br>fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br>include fastcgi_params;<br>}<br>access_log /home/logs/api.m.woniuanjia.com/access.log access;<br>error_log /home/logs/api.m.woniuanjia.com/error.log info;<br>}<br>$&amp;: www.m.woniuanjia.com#<br>server {<br>listen 80;<br>server_name www.m.woniuanjia.com;<br>charset utf-8;<br>root /home/app/www.m.woniuanjia.com/v1.0/;<br>location / {<br>index index.php index.html index.htm;<br>}<br>location /v1.0/ {<br>index index.php;<br>alias /home/app/www.m.woniuanjia.com/v1.0/;<br>}<br>error_page 500 502 503 504 /50x.html;<br>location = /50x.html {<br>root html;<br>}<br>location ~ ^/v1.0/(.</em>.php)$ {<br>fastcgi_pass 127.0.0.1:9000;<br>fastcgi_index index.php;<br>fastcgi_param SCRIPT_FILENAME /home/app/www.m.woniuanjia.com/v1.0/$1;<br>include fastcgi_params;<br>}<br>location ~ .php$ {<br>fastcgi_pass 127.0.0.1:9000;<br>fastcgi_index index.php;<br>fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br>include fastcgi_params;<br>}<br>access_log /home/logs/www.m.woniuanjia.com/access.log access;<br>error_log /home/logs/www.m.woniuanjia.com/error.log info;<br>}<br>$&amp;: demo.woniuanjia.com#<br>server {<br>listen 80;<br>server_name demo.woniuanjia.com;<br>root /home/app/demo.woniuanjia.com/v1.0/;<br>location / {<br>index index.php index.html index.htm;<br>if (!-e $request_filename) {<br>rewrite ^/(.<em>)$ /index.php?$1 last;<br>break;<br>}<br>}<br>location ~ .php$ {<br>fastcgi_pass 127.0.0.1:9000;<br>fastcgi_index index.php;<br>fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br>include fastcgi_params;<br>}<br>access_log /home/logs/demo.woniuanjia.com/access.log access;<br>error_log /home/logs/demo.woniuanjia.com/error.log info;<br>}<br>$&amp;: img.woniuanjia.com#<br>server {<br>listen 80;<br>server_name img.m.woniuanjia.com;<br>root /home/app/img.m.woniuanjia.com/;<br>location / {<br>index index.php index.html index.htm;<br>if (!-e $request_filename) {<br>rewrite ^/(.</em>)$ /index.php?$1 last;<br>break;<br>}<br>}<br>}<br>$&amp;: finish<br>}<br>$&amp;: vim /etc/security/limits.conf</p>
<ul>
<li>soft    nproc   16384</li>
<li>hard    nproc   16384</li>
<li>soft    nofile  4096</li>
<li>hard    nofile  65536</li>
<li>soft    stack   10240<br>修改完之后退出重新登录生效<br>$&amp;: ulimit -n<br>$&amp;: ulimit -a<br>$&amp;: mkdir /home/crontab<br>$&amp;: vim /home/crontab/cut_nginx_log.sh<br>$&amp;: !/bin/bash<br>$&amp;: auth peter<br>$&amp;:  定时切割Nginx日志的脚本<br>$&amp;:  每小时生产一份日志<br>$&amp;:  如果是每月1号,则将上月日志归档<br>today=<code>date +%e</code><br>monthlog=<code>date -d ‘-1 month’ +%Y%m</code><br>hour=<code>date +%k</code><br>hour_accesslogname=<code>date +”%Y%m%d%H” –date=”-1 hour”</code><br>day_errorlogname=<code>date +”%Y%m%d” –date=”-1 day”</code><br>$&amp;:  The Nginx logs path<br>$&amp;: 切割api.m.woniuanjia.com日志<br>logs_path=”/home/logs/api.m.woniuanjia.com/”<br>mv ${logs_path}access.log ${logs_path}access-${hour_accesslogname}.log<br>if [ $hour -eq 0 ]; then<br>mv ${logs_path}error.log ${logs_path}error-${day_errorlogname}.log<br>fi<br>if [ $today -eq 1 ]; then<br>if [ ! -e ${logs_path}${monthlog} ]; then<br>mkdir ${logs_path}${monthlog}<br>fi<br>mv ${logs_path}access-${monthlog}<em>.log ${logs_path}${monthlog}<br>mv ${logs_path}error-${monthlog}</em>.log ${logs_path}${monthlog}<br>fi<br>$&amp;: 切割www.m.woniuanjia.com日志<br>logs_path=”/home/logs/www.m.woniuanjia.com/”<br>mv ${logs_path}access.log ${logs_path}access-${hour_accesslogname}.log<br>if [ $hour -eq 0 ]; then<br>mv ${logs_path}error.log ${logs_path}error-${day_errorlogname}.log<br>fi<br>if [ $today -eq 1 ]; then<br>if [ ! -e ${logs_path}${monthlog} ]; then<br>mkdir ${logs_path}${monthlog}<br>fi<br>mv ${logs_path}access-${monthlog}<em>.log ${logs_path}${monthlog}<br>mv ${logs_path}error-${monthlog}</em>.log ${logs_path}${monthlog}<br>fi<br>$&amp;: 切割demo.woniuanjia.com日志<br>logs_path=”/home/logs/demo.woniuanjia.com/”<br>mv ${logs_path}access.log ${logs_path}access-${hour_accesslogname}.log<br>if [ $hour -eq 0 ]; then<br>mv ${logs_path}error.log ${logs_path}error-${day_errorlogname}.log<br>fi<br>if [ $today -eq 1 ]; then<br>if [ ! -e ${logs_path}${monthlog} ]; then<br>mkdir ${logs_path}${monthlog}<br>fi<br>mv ${logs_path}access-${monthlog}<em>.log ${logs_path}${monthlog}<br>mv ${logs_path}error-${monthlog}</em>.log ${logs_path}${monthlog}<br>fi<br>kill -USR1 <code>cat /usr/local/nginx/logs/nginx.pid</code><br>$&amp;: chmod +x /home/crontab/cut_nginx_log.sh<br>$&amp;: chown www:www /home/crontab/cut_nginx_log.sh<br>$&amp;: crontab -e<br>00 10 <em> </em> * /bin/bash /home/crontab/cut_nginx_log.sh<br>$&amp;: vim /etc/rc.d/rc.local<br>/usr/local/nginx/sbin/nginx<br>$&amp;: /usr/local/nginx/sbin/nginx -t<br>$&amp;: /usr/local/nginx/sbin/nginx<br>$&amp;: /usr/local/nginx/sbin/nginx -s reload<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">安装mysql</span><br><span class="line">$&amp;: <span class="keyword">cd</span> /home/tools/</span><br><span class="line">$&amp;: wget http:<span class="comment">//dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.15.tar.gz</span></span><br><span class="line">$&amp;: wget http:<span class="comment">//www.cmake.org/files/v2.8/cmake-2.8.4.tar.gz</span></span><br><span class="line">$&amp;: wget http:<span class="comment">//ftp.gnu.org/gnu/bison/bison-3.0.4.tar.gz</span></span><br><span class="line">$&amp;: tar zxvf cmake-2.8.4.tar.gz</span><br><span class="line">$&amp;: <span class="keyword">cd</span> cmake-2.8.4</span><br><span class="line">$&amp;: ./<span class="keyword">bootstrap</span></span><br><span class="line">$&amp;: gmake</span><br><span class="line">$&amp;: gmake install</span><br><span class="line">$&amp;: <span class="keyword">cd</span> ..</span><br><span class="line">$&amp;: tar zxvf bison-3.0.4.tar.gz</span><br><span class="line">$&amp;: <span class="keyword">cd</span> bison-3.0.4/</span><br><span class="line">$&amp;: ./configure</span><br><span class="line">$&amp;: make</span><br><span class="line">$&amp;: make install</span><br><span class="line">$&amp;: <span class="keyword">cd</span> ..</span><br><span class="line">$&amp;: /usr/sbin/groupadd mysql</span><br><span class="line">$&amp;: /usr/sbin/useradd -<span class="keyword">g</span> mysql mysql</span><br><span class="line">$&amp;: vim /etc/passwd</span><br><span class="line">mysql:x:501:501::/home/mysql:/sbin/nologin</span><br><span class="line">$&amp;: tar -zxvf mysql-5.6.24.tar.gz</span><br><span class="line">$&amp;: <span class="keyword">cd</span> mysql-5.6.24</span><br><span class="line">$&amp;: cmake -DCMAKE_INSTALL_PREFIX=/usr/<span class="keyword">local</span>/mysql \</span><br><span class="line">-DMYSQL_UNIX_ADDR=/usr/<span class="keyword">local</span>/mysql/mysql.sock \</span><br><span class="line">-DDEFAULT_CHARSET=utf8 \</span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">-DWITH_EXTRA_CHARSETS:STRING=utf8,gbk \</span><br><span class="line">-DWITH_MYISAM_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DENABLED_LOCAL_INFILE=1 \</span><br><span class="line">-DMYSQL_DATADIR=/usr/<span class="keyword">local</span>/mysql/data</span><br><span class="line">PS:</span><br><span class="line">以上参数等说明:</span><br><span class="line">DCMAKE_INSTALL_PREFIX=/usr/<span class="keyword">local</span>/mysql #mysql安装的主目录，默认为/usr/<span class="keyword">local</span>/mysql</span><br><span class="line">DMYSQL_DATADIR=/usr/<span class="keyword">local</span>/mysql/data #mysql数据库文件的存放目录，可以自定义</span><br><span class="line">DMYSQL_UNIX_ADDR=/usr/<span class="keyword">local</span>/mysql/mysql.sock #系统Socket文件（.sock）设置,基于该文件路径进行Socket链接，必须为绝对路径</span><br><span class="line">DSYSCONFDIR=/etc #mysql配置文件 my.cnf的存放地址，默认为/etc下</span><br><span class="line">DMYSQL_TCP_PORT=3306 #数据库服务器监听端口，默认为3306</span><br><span class="line">DENABLED_LOCAL_INFILE=1 #允许从本地导入数据</span><br><span class="line">DWITH_READLINE=1 #快捷键功能</span><br><span class="line">DWITH_SSL=yes #支持 SSL</span><br><span class="line">DMYSQL_USER=mysql #默认为mysql</span><br><span class="line"><span class="comment">//下面3个是数据库编码设置</span></span><br><span class="line">DEXTRA_CHARSETS=all #安装所有扩展字符集，默认为all</span><br><span class="line">DDEFAULT_CHARSET=utf8 #使用 utf8 字符</span><br><span class="line">DDEFAULT_COLLATION=utf8_general_ci #校验字符</span><br><span class="line"><span class="comment">//下面5个是数据库存储引擎设在</span></span><br><span class="line">DWITH_MYISAM_STORAGE_ENGINE=1 #安装 myisam 存储引擎</span><br><span class="line">DWITH_INNOBASE_STORAGE_ENGINE=1 #安装 innodb 存储引擎</span><br><span class="line">DWITH_ARCHIVE_STORAGE_ENGINE=1 #安装 archive 存储引擎</span><br><span class="line">DWITH_BLACKHOLE_STORAGE_ENGINE=1 #安装 blackhole 存储引擎</span><br><span class="line">DWITH_PARTITION_STORAGE_ENGINE=1 #安装数据库分区</span><br><span class="line"></span><br><span class="line">$&amp;: make</span><br><span class="line">--------------------------</span><br><span class="line">----可能报错</span><br><span class="line">          FATAL <span class="keyword">ERROR</span>: Could not find ./bin/my_print_defaults</span><br><span class="line">          <span class="keyword">If</span> you compiled from source, you need to <span class="keyword">run</span> 'make install' to</span><br><span class="line">          <span class="keyword">copy</span> the software into the correct location ready <span class="keyword">for</span> operation.</span><br><span class="line">          <span class="keyword">If</span> you are using a binary release, you must either be at the top</span><br><span class="line">          level of the extracted archive, or pass the --basedir option</span><br><span class="line">          pointing to that location.</span><br><span class="line"></span><br><span class="line">----解决方案</span><br><span class="line">-------- /usr/<span class="keyword">local</span>/bin/mysql_install_db --user=mysql --basedir=/usr/<span class="keyword">local</span>/ --datadir=/<span class="keyword">var</span>/<span class="keyword">db</span>/mysql &amp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$&amp;: make install</span><br><span class="line">$&amp;: chmod +w /usr/<span class="keyword">local</span>/mysql</span><br><span class="line">$&amp;: chown -R mysql:mysql /usr/<span class="keyword">local</span>/mysql #改变目录拥有者与所属组</span><br><span class="line">$&amp;: ln -s /usr/<span class="keyword">local</span>/mysql/lib/libmysqlclient.<span class="keyword">so</span>.16 /usr/lib/libmysqlclient.<span class="keyword">so</span>.16</span><br><span class="line">$&amp;: ln -s /usr/<span class="keyword">local</span>/mysql/lib/libmysqlclient.<span class="keyword">so</span>.16 /usr/lib64/libmysqlclient.<span class="keyword">so</span>.16</span><br><span class="line">$&amp;: <span class="keyword">cd</span> support-files/</span><br><span class="line">$&amp;: cp my-default.cnf /etc/my.cnf #选择默认配置文件 适合大型服务器</span><br><span class="line">cp：是否覆盖”/etc/my.cnf”？ <span class="literal">y</span></span><br><span class="line">$&amp;: cp mysql.server /etc/init.<span class="keyword">d</span>/mysqld #复制启动文件</span><br><span class="line">$&amp;: vim /etc/my.cnf</span><br><span class="line">在[mysqld]下面添加</span><br><span class="line">basedir = /usr/<span class="keyword">local</span>/mysql/</span><br><span class="line">datadir = /usr/<span class="keyword">local</span>/mysql/data</span><br><span class="line"><span class="keyword">log</span>-<span class="keyword">error</span> = /usr/<span class="keyword">local</span>/mysql/mysql_error.<span class="literal">log</span></span><br><span class="line">pid-<span class="keyword">file</span> = /usr/<span class="keyword">local</span>/mysql/data/mysql.pid</span><br><span class="line">default-storage-engine=INNODB</span><br><span class="line">user = mysql</span><br><span class="line">$&amp;: /usr/<span class="keyword">local</span>/mysql/scripts/mysql_install_db \</span><br><span class="line">–basedir=/usr/<span class="keyword">local</span>/mysql \</span><br><span class="line">–datadir=/usr/<span class="keyword">local</span>/mysql/data \</span><br><span class="line">–user=mysql</span><br><span class="line">$&amp;: chmod +x /etc/init.<span class="keyword">d</span>/mysqld</span><br><span class="line">$&amp;: vim /etc/init.<span class="keyword">d</span>/mysqld（编辑此文件，查找并修改以下变量内容：）</span><br><span class="line">basedir=/usr/<span class="keyword">local</span>/mysql</span><br><span class="line">datadir=/usr/<span class="keyword">local</span>/mysql/data</span><br><span class="line">$&amp;: chkconfig –add mysqld</span><br><span class="line">$&amp;: chkconfig –level 345 mysqld <span class="keyword">on</span></span><br><span class="line">$&amp;: export PATH=/usr/<span class="keyword">local</span>/mysql/bin:<span class="label">$PATH</span> <span class="comment">//为MySQL配置环境变量，以后使用起来方便</span></span><br><span class="line">$&amp;: service mysqld start</span><br><span class="line">Starting MySQL. SUCCESS!</span><br><span class="line">$&amp;: mysql_secure_installation</span><br><span class="line"><span class="keyword">NOTE</span>: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED <span class="keyword">FOR</span> ALL MySQL</span><br><span class="line">SERVERS <span class="keyword">IN</span> PRODUCTION <span class="keyword">USE</span>! PLEASE <span class="keyword">READ</span> EACH STEP CAREFULLY!</span><br><span class="line"><span class="keyword">In</span> <span class="keyword">order</span> to <span class="keyword">log</span> into MySQL to secure it, we’ll need the current</span><br><span class="line">password <span class="keyword">for</span> the root user. <span class="keyword">If</span> you’ve just installed MySQL, and</span><br><span class="line">you haven’t <span class="keyword">set</span> the root password yet, the password will be blank,</span><br><span class="line"><span class="keyword">so</span> you should just press enter here.</span><br><span class="line">Enter current password <span class="keyword">for</span> root (enter <span class="keyword">for</span> none): 输入mysql的root密码，默认为空</span><br><span class="line">OK, successfully used password, moving <span class="keyword">on</span>…</span><br><span class="line">Setting the root password ensures that nobody can <span class="keyword">log</span> into the MySQL</span><br><span class="line">root user without the proper authorisation.</span><br><span class="line">You already have a root password <span class="keyword">set</span>, <span class="keyword">so</span> you can safely answer ‘<span class="keyword">n</span>’.</span><br><span class="line">Change the root password? [Y/<span class="keyword">n</span>] y <span class="comment">//是否修改mysql的密码，选择y</span></span><br><span class="line">New password: 输入mysql的密码</span><br><span class="line">Re-enter new password: 重复输入mysql的密码</span><br><span class="line">Password updated successfully!<span class="comment">//密码修改成功</span></span><br><span class="line">Reloading privilege tables..</span><br><span class="line">… Success!</span><br><span class="line"><span class="keyword">By</span> default, a MySQL installation has <span class="keyword">an</span> anonymous user, allowing anyone</span><br><span class="line">to <span class="keyword">log</span> into MySQL without having to have a user account created <span class="keyword">for</span></span><br><span class="line">them. This is intended only <span class="keyword">for</span> testing, and to make the installation</span><br><span class="line">go a bit smoother. You should remove them before moving into a</span><br><span class="line">production environment.</span><br><span class="line">Remove anonymous users? [Y/<span class="keyword">n</span>] y <span class="comment">//删除匿名用户</span></span><br><span class="line">… Success!</span><br><span class="line">Normally, root should only be allowed to connect from ‘localhost’. This</span><br><span class="line">ensures that someone cannot guess at the root password from the network.</span><br><span class="line">Disallow root login remotely? [Y/<span class="keyword">n</span>] y <span class="comment">//禁止root远程登录</span></span><br><span class="line">… skipping.</span><br><span class="line"><span class="keyword">By</span> default, MySQL comes with a database named ‘<span class="keyword">test</span>’ that anyone can</span><br><span class="line">access. This is also intended only <span class="keyword">for</span> testing, and should be removed</span><br><span class="line">before moving into a production environment.</span><br><span class="line">Remove <span class="keyword">test</span> database and access to it? [Y/<span class="keyword">n</span>] y <span class="comment">//删除测试数据库和访问它</span></span><br><span class="line">– Dropping <span class="keyword">test</span> database…</span><br><span class="line"><span class="keyword">ERROR</span> 1010 (HY000) at <span class="keyword">line</span> 1: <span class="keyword">Error</span> dropping database (can’t <span class="keyword">rmdir</span> ‘./<span class="keyword">test</span>/’, errno: 17)</span><br><span class="line">… Failed! Not critical, <span class="keyword">keep</span> moving…</span><br><span class="line">– Removing privileges <span class="keyword">on</span> <span class="keyword">test</span> database…</span><br><span class="line">… Success!</span><br><span class="line">Reloading the privilege tables will ensure that all changes made <span class="keyword">so</span> far</span><br><span class="line">will take effect immediately.</span><br><span class="line">Reload privilege tables now? [Y/<span class="keyword">n</span>] y <span class="comment">//现在重载授权表</span></span><br><span class="line">… Success!</span><br><span class="line">Cleaning up…</span><br><span class="line">All done! <span class="keyword">If</span> you’ve completed all of the above steps, your MySQL</span><br><span class="line">installation should now be secure.</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> using MySQL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改mysql密码-----<span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> 'root'@'localhost' = PASSWORD('root123');</span><br><span class="line">查看及修改mysql最大连接数</span><br><span class="line">$&amp;: ps -axef | grep mysqld –c</span><br><span class="line">mysql&gt; show engines; <span class="comment">//看你的mysql现在已提供什么存储引擎:</span></span><br><span class="line">+——————–+———+—————————————————————-+————–+——+————+</span><br><span class="line">| Engine | Support | Comment | Transactions | XA | Savepoints |</span><br><span class="line">+——————–+———+—————————————————————-+————–+——+————+</span><br><span class="line">| MyISAM | YES | MyISAM storage engine | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| CSV | YES | CSV storage engine | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| MRG_MYISAM | YES | Collection of identical MyISAM tables | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| BLACKHOLE | YES | /dev/null storage engine (anything you write to it disappears) | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| <span class="keyword">MEMORY</span> | YES | Hash based, stored <span class="keyword">in</span> <span class="keyword">memory</span>, useful <span class="keyword">for</span> temporary tables | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| FEDERATED | <span class="keyword">NO</span> | Federated MySQL storage engine | NULL | NULL | NULL |</span><br><span class="line">| ARCHIVE | YES | Archive storage engine | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| PERFORMANCE_SCHEMA | YES | Performance Schema | <span class="keyword">NO</span> | <span class="keyword">NO</span> | <span class="keyword">NO</span> |</span><br><span class="line">| InnoDB | DEFAULT | Supports transactions, row-level locking, and foreign keys | YES | YES | YES |</span><br><span class="line">+——————–+———+—————————————————————-+————–+——+————+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="keyword">set</span> (0.00 sec)</span><br><span class="line">mysql&gt; show variables like ‘%storage_engine%’;<span class="comment">//看你的mysql当前默认的存储引擎:</span></span><br><span class="line">+—————————-+——–+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+—————————-+——–+</span><br><span class="line">| default_storage_engine | InnoDB |</span><br><span class="line">| default_tmp_storage_engine | InnoDB |</span><br><span class="line">| storage_engine | InnoDB |</span><br><span class="line">+—————————-+——–+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="keyword">set</span> (0.00 sec)</span><br><span class="line">你要看某个表用了什么引擎(在显示结果里参数engine后面的就表示该表当前用的存储引擎):</span><br><span class="line">mysql&gt; show create <span class="keyword">table</span> 表名;</span><br><span class="line"> </span><br><span class="line">Mysql&gt;show variables like ‘max_connections’;</span><br><span class="line">Mysql&gt; <span class="keyword">set</span> <span class="keyword">GLOBAL</span> max_connections=2000;</span><br><span class="line">Mysql&gt; show variables like ‘max_connections’;</span><br><span class="line">Mysql&gt; show processlist;<span class="comment">//查看mysql的数据库连接</span></span><br><span class="line">$&amp;: Vim /etc/my.cnf <span class="comment">//在mysqld中增加如下内容：</span></span><br><span class="line">max_connections=500</span><br><span class="line">back_log=100</span><br><span class="line">$&amp;: <span class="keyword">mkdir</span> -p /<span class="keyword">var</span>/lib/mysql</span><br><span class="line">$&amp;: ln -s /usr/<span class="keyword">local</span>/mysql/mysql.sock /<span class="keyword">var</span>/lib/mysql/mysql.sock</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>安装php<br>$&amp;: cd /home/tools/<br>$&amp;: tar -zxvf php-5.6.8.tar.gz<br>$&amp;: yum -y install gd curl curl-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel mysql mysql-devel<br>$&amp;: cd php-5.6.8<br>$&amp;: ./configure –prefix=/usr/local/php –enable-fpm –enable-debug –with-gd –with-jpeg-dir –with-png-dir –with-freetype-dir –enable-mbstring –with-curl –with-mysql=/usr/local/mysql/ –with-mysqli=/usr/local/mysql/bin/mysql_config<br>$&amp;: ./configure –prefix=/usr/local/php –enable-fpm –disable-debug –with-gd –with-jpeg-dir –with-png-dir –with-freetype-dir –enable-mbstring –with-curl –with-mysql=/usr/local/mysql/ –with-mysqli=/usr/local/mysql/bin/mysql_config<br>只有在开发php扩展库的时候需要开启–enable-debug，生产环境不需要，否则会影响性能。开发人员无法安装zend debug。<br>$&amp;: make<br>$&amp;: make install<br>$&amp;: cp php.ini-development /usr/local/php/lib/php.ini<br>$&amp;: cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf<br>$&amp;: vim /usr/local/php/lib/php.ini<br>修改927行，修改之后如下：date.timezone = Asia/Chongqing<br>$&amp;: vim /usr/local/php/etc/php-fpm.conf<br>修改;pid = run/php-fpm.pid 为pid = run/php-fpm.pid<br>$&amp;: /usr/local/php/sbin/php-fpm<br>验证php和nginx的安装<br>$&amp;: cd /home/app/api.m.woniuanjia.com/v1.0/web<br>$&amp;: vim a.php<br>&lt;?php<br>phpinfo();<br>?&gt;<br>在浏览器中输入 <a href="http://api.m.woniuanjia.com/a.php" target="_blank" rel="external">http://api.m.woniuanjia.com/a.php</a><br>看到PHPinfo页面，解析PHP正常<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$&amp;: ps aux | grep -c php-fpm <span class="comment">//查看php-fpm进程数</span></span><br><span class="line">$&amp;: /usr/bin/php -i|grep mem <span class="comment">//查看运行内存</span></span><br><span class="line">$&amp;: /etc/init.<span class="keyword">d</span>/php-fpm restart <span class="comment">//重启php-fpm</span></span><br><span class="line">$&amp;: vim /usr/<span class="keyword">local</span>/php/etc/php-fpm.<span class="keyword">conf</span></span><br><span class="line">pid = <span class="keyword">run</span>/php-fpm.pid <span class="comment">//把注释去掉</span></span><br><span class="line">$&amp;: /usr/<span class="keyword">local</span>/php/sbin/php-fpm <span class="comment">//php-fpm 启动php-fpm</span></span><br><span class="line">$&amp;: kill -INT `<span class="keyword">cat</span> /usr/<span class="keyword">local</span>/php/<span class="keyword">var</span>/<span class="keyword">run</span>/php-fpm.pid` <span class="comment">//关闭php-fpm</span></span><br><span class="line">$&amp;: kill -USR2 `<span class="keyword">cat</span> /usr/<span class="keyword">local</span>/php/<span class="keyword">var</span>/<span class="keyword">run</span>/php-fpm.pid` <span class="comment">//重启php-fpm</span></span><br><span class="line">$&amp;: ps aux | grep -c php-fpm <span class="comment">//查看php-fpm进程数</span></span><br></pre></td></tr></table></figure></p>
<p>安装redis<br>$&amp;: cd /home/tools/<br>$&amp;: wget <a href="http://download.redis.io/releases/redis-3.0.1.tar.gz" target="_blank" rel="external">http://download.redis.io/releases/redis-3.0.1.tar.gz</a><br>$&amp;: tar -zxvf redis-3.0.1.tar.gz<br>$&amp;: cd redis-3.0.1/<br>$&amp;: make<br>make命令执行完成后，会在当前src目录下生成本个可执行文件，分别是redis-server、redis-cli、redis-benchmark、redis-stat，它们的作用如下：<br>redis-server：Redis服务器的daemon启动程序<br>redis-cli：Redis命令行操作工具。当然，你也可以用telnet根据其纯文本协议来操作<br>redis-benchmark：Redis性能测试工具，测试Redis在你的系统及你的配置下的读写性能<br>redis-stat：Redis状态检测工具，可以检测Redis当前状态参数及延迟状况。<br>$&amp;: cp redis.conf /etc/ //这个文件是redis启动的配置文件<br>$&amp;: cd src/<br>$&amp;: cp redis-benchmark redis-cli redis-server /usr/bin/ //这个倒是很有用，这样就不用再执行时加上./了，而且可以在任何地方执行<br>$&amp;: redis-server /etc/redis.conf //启动redis<br>$&amp;: vim /etc/redis.conf<br>将daemonize no修改为daemonize yes<br>保存退出<br>$&amp;: nohup redis-server /etc/redis.conf<br>$&amp;: redis-cli shutdown //关闭redis服务<br>redis服务关闭后，缓存数据会自动dump到硬盘上，硬盘地址为redis.conf中的配置项dbfilename dump.rdb所设定<br>$&amp;: redis-cli save 或者 redis-cli -p 6380 save（指定端口） //强制备份数据到磁盘，使用如下命令<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">安装redis.so模块</span><br><span class="line">$&amp;: cd <span class="regexp">/home/</span>tools/</span><br><span class="line">$&amp;: wget <span class="string">https:</span><span class="comment">//github.com/nicolasff/phpredis/archive/master.zip</span></span><br><span class="line">$&amp;: unzip master.zip</span><br><span class="line">$&amp;: cd phpredis-master/</span><br><span class="line">$&amp;: <span class="regexp">/usr/</span>local<span class="regexp">/php/</span>bin/phpize</span><br><span class="line">$&amp;: .<span class="regexp">/configure –with-php-config=/</span>usr<span class="regexp">/local/</span>php<span class="regexp">/bin/</span>php-config</span><br><span class="line">$&amp;: make</span><br><span class="line">$&amp;: make install</span><br><span class="line">Installing shared <span class="string">extensions:</span> <span class="regexp">/usr/</span>local<span class="regexp">/php/</span>lib<span class="regexp">/php/</span>extensions<span class="regexp">/debug-non-zts-20131226/</span></span><br><span class="line">注意redis.so的全路径是：</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/php/</span>lib<span class="regexp">/php/</span>extensions<span class="regexp">/debug-non-zts-20131226/</span>redis.so</span><br><span class="line">$&amp;: vim <span class="regexp">/usr/</span>local<span class="regexp">/php/</span>lib/php.ini</span><br><span class="line">手工修改：查找<span class="regexp">/usr/</span>local<span class="regexp">/php/</span>lib<span class="regexp">/php.ini中的extension_dir = “./</span>”</span><br><span class="line">修改为extension_dir = “<span class="regexp">/usr/</span>local<span class="regexp">/php/</span>lib<span class="regexp">/php/</span>extensions<span class="regexp">/debug-non-zts-20131226/</span>”</span><br><span class="line">并在此行后增加以下几行，然后保存：</span><br><span class="line">extension = “redis.so”</span><br></pre></td></tr></table></figure></p>
<p>安装PDO-mysql<br>$&amp;: cd /home/tools/<br>$&amp;: wget <a href="http://pecl.php.net/get/PDO_MYSQL-1.0.2.tgz" target="_blank" rel="external">http://pecl.php.net/get/PDO_MYSQL-1.0.2.tgz</a><br>$&amp;: tar zxvf PDO_MYSQL-1.0.2.tgz<br>package2.xml<br>PDO_MYSQL-1.0.2/config.m4<br>PDO_MYSQL-1.0.2/CREDITS<br>PDO_MYSQL-1.0.2/mysql_driver.c<br>PDO_MYSQL-1.0.2/mysql_statement.c<br>PDO_MYSQL-1.0.2/pdo_mysql.c<br>PDO_MYSQL-1.0.2/php_pdo_mysql.h<br>PDO_MYSQL-1.0.2/php_pdo_mysql_int.h<br>PDO_MYSQL-1.0.2/php_pdo_mysql_sqlstate.h<br>package.xml<br>$&amp;: cd PDO_MYSQL-1.0.2<br>$&amp;: /usr/local/php/bin/phpize<br>Configuring for:<br>PHP Api Version: 20131106<br>Zend Module Api No: 20131226<br>Zend Extension Api No: 220131226<br>$&amp;: ./configure –with-php-config=/usr/local/php/bin/php-config<br>$&amp;: make<br>执行时报错如下：<br>cc -I -I/usr/local/mysql/include -g -fabi-version=2 -fno-omit-frame-pointer -fno-strict-aliasing -I. -I/home/tools/PDO_MYSQL-1.0.2 -DPHP_ATOM_INC -I/home/tools/PDO_MYSQL-1.0.2/include -I/home/tools/PDO_MYSQL-1.0.2/main -I/home/tools/PDO_MYSQL-1.0.2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib -DHAVE_CONFIG_H -g -O0 -c /home/tools/PDO_MYSQL-1.0.2/pdo_mysql.c -fPIC -DPIC -o .libs/pdo_mysql.o<br>In file included from /home/tools/PDO_MYSQL-1.0.2/pdo_mysql.c:31:0:<br>/home/tools/PDO_MYSQL-1.0.2/php_pdo_mysql_int.h:25:19: 致命错误：mysql.h：没有那个文件或目录<br>$&amp;: include <mysql.h><br>^<br>编译中断。<br>make: <em>** [pdo_mysql.lo] 错误 1<br>解决办法：<br>$&amp;:  ln -s /usr/local/mysql/include/</em> /usr/local/include/<br>$&amp;: make<br>$&amp;: make install<br>Installing shared extensions: /usr/local/php/lib/php/extensions/debug-non-zts-20131226/<br>$&amp;: vim /usr/local/php/lib/php.ini<br>在extension = “redis.so”下面增加<br>extension = “pdo_mysql.so”</mysql.h></p>
<p><del>~</del><del>~</del><del>~</del><del>~</del><del>~</del><del>~</del>~~~<br>安装phpopenssl<br>$&amp;: cd /home/tools/php-5.6.8/ext/openssl<br>$&amp;: cp config0.m4 config.m4<br>$&amp;: /usr/local/php/bin/phpize<br>$&amp;: ./configure –with-php-config=/usr/local/php/bin/php-config<br>$&amp;: make<br>$&amp;: make install<br>Installing shared extensions: /usr/local/php/lib/php/extensions/debug-non-zts-20131226/<br>$&amp;: vim /usr/local/php/lib/php.ini<br>在extension_dir 参数下面增加extension = “openssl.so”<br>保存退出，重启php<br>＃kill -USR2 <code>cat /usr/local/php/var/run/php-fpm.pid</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/11/lnmp[基于contos]的服务器搭建/" data-id="cij6wm6ot000m4wjpg33283hw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/11/12/在Linux中将php-fpm配置成服务的方法/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          在Linux中将php-fpm配置成服务的方法
        
      </div>
    </a>
  
  
    <a href="/2015/11/10/nginx虚拟主机配置/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">nginx虚拟主机的配置文件</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/apache/">apache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/composer/">composer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/laravel/">laravel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/layout/">layout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lgit/">lgit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pdo/">pdo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php7/">php7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/抓包/">抓包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/框架/">框架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语言/">语言</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/composer/" style="font-size: 10px;">composer</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/laravel/" style="font-size: 10px;">laravel</a> <a href="/tags/layout/" style="font-size: 10px;">layout</a> <a href="/tags/lgit/" style="font-size: 10px;">lgit</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/nginx/" style="font-size: 12.5px;">nginx</a> <a href="/tags/pdo/" style="font-size: 10px;">pdo</a> <a href="/tags/php/" style="font-size: 17.5px;">php</a> <a href="/tags/php7/" style="font-size: 10px;">php7</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/框架/" style="font-size: 10px;">框架</a> <a href="/tags/语言/" style="font-size: 10px;">语言</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/01/09/PHP7的PHP-Redis扩展/">PHP7的PHP-Redis扩展</a>
          </li>
        
          <li>
            <a href="/2016/01/08/https站点的搭建/">Https站点搭建</a>
          </li>
        
          <li>
            <a href="/2016/01/07/linux下php开启pdo扩展模块步骤/">linux下php开启pdo扩展模块步骤</a>
          </li>
        
          <li>
            <a href="/2015/12/11/修改php.ini报错级别/">mysql权限分配</a>
          </li>
        
          <li>
            <a href="/2015/11/14/用队列的方式解决目录遍历问题/">用队列的方式解决目录遍历问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 xiaoyanegr<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>